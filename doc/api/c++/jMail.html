<!DOCTYPE HTML PUBLIC "-//IETF//DTD HTML//EN">
<html>
<head>
<meta http-equiv="Content-Type"
content="text/html; charset=iso-8859-1">
<meta name="GENERATOR" content="Java2Html 1.5
by Lorenzo Bettini, lorenzo.bettini@penteres.it
http://w3.newnet.it/bettini
http://www.gnu.org/software/Java2Html/Java2Html.html">
<title>../../umail/jMail.h</title>
</head>
<body bgcolor="#FFFFFF" text="#000000" link="#0000EE" vlink="#551A8B" alink="#FF0000">
<pre>
<tt>
<font color=#9A1900>/*
 * Copyright (C) 2003 HawkinsSoftware
 *
 * This prototype of the Decaf Java development environment is free 
 * software.  You can redistribute it and/or modify it under the terms 
 * of the GNU General Public License as published by the Free Software 
 * Foundation.  However, no compilation of this code or a derivative
 * of it may be used with or integrated into any commercial application,
 * except by the written permisson of HawkinsSoftware.  Future versions 
 * of this product will be sold commercially under a different license.  
 * HawkinsSoftware retains all rights to this product, including its
 * concepts, design and implementation.
 *
 * This prototype is distributed in the hope that it will be useful,
 * but WITHOUT ANY WARRANTY; without even the implied warranty of
 * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the
 * GNU General Public License for more details.
 *
 * You should have received a copy of the GNU General Public License
 * along with this program; if not, write to the Free Software
 * Foundation, Inc., 59 Temple Place, Suite 330, Boston, MA 02111-1307 USA
 */</font>
<font color=#9A1900>// <a name="start"/>
</font>
<font color=#9A1900>// jmail.h
</font>
<font color=#9A1900>/*
uMail classes are made available to Java plugins via wrapper classes here in 
jMail.  Each jMail class is derived from <a href="plugin.html#jType">jType</a>, and by its 
policy contains a pointer to the single object it wraps.  Methods available to
Java on the wrapped object must be declared public on the jMail wrapper class
and routed accordingly.  jMail is the basis of the dynamic library loaded by 
Java.  A Java version of each jMail class is generated by SWIG, along with an
export method.  In this way, the user of jMail classes in Java has essentially
transparent access to the public methods of these native jMail classes.

In this rendition of uMail, the dynamic library links with the binary code of 
the main application.  See <a href="plugin.html#jPluginLib">jPluginLib</a> for the skinny on this odd predicament.
*/</font>

<font color=#0000FF>#include</font> <font color=#FF0000>&lt;stdlib.h&gt;</font>
<font color=#0000FF>#include</font> <font color=#FF0000>&lt;jni.h&gt;</font>
<font color=#0000FF>#include</font> <font color=#FF0000>&lt;time.h&gt;</font>

<font color=#0000FF>#ifndef</font> __jmail_h__
<font color=#0000FF>#define</font> __jmail_h__

<font color=#0000FF>#include</font> <font color=#FF0000>&lt;forward.h&gt;</font>
<font color=#0000FF>#include</font> <font color=#FF0000>&lt;plugin.h&gt;</font>
<font color=#0000FF>#include</font> <font color=#FF0000>&lt;ui.h&gt;</font>

<font color=#9A1900>// <a name="jTime"/>
</font><font color=#9A1900>/*
jTime represents a date and time in a format that can be applied to a 
<a href="uMail_i.html#jTime">java.util.Date</a> and a tm* (from time.h).  
*/</font>
<font color=#0000FF>class</font> jTime 
{
<font color=#0000FF>private</font>:
    tm* data;
<font color=#0000FF>public</font>:
    jTime() {};     <font color=#9A1900>// bogus, not instantiated from Java
</font>
    <font color=#009900>int</font> getSecond();
    <font color=#009900>int</font> getMinute();
    <font color=#009900>int</font> getHour();
    <font color=#009900>int</font> getDay();
    <font color=#009900>int</font> getMonth();
    <font color=#009900>int</font> getYear();
    <font color=#009900>bool</font> isDST();
    
<font color=#9A1900>// impl only
</font>    jTime(tm* t);
};

<font color=#9A1900>// <a name="jAddressee"/>
</font><font color=#0000FF>class</font> jAddressee : <font color=#0000FF>public</font> jType
{
<font color=#0000FF>private</font>:
    Addressee* addressee;
<font color=#0000FF>public</font>:
    jAddressee(<font color=#009900>void</font>* a);
    <font color=#0000FF>const</font> <font color=#009900>char</font>* getAddress();
};

<font color=#9A1900>// <a name="jMessage"/>
</font><font color=#9A1900>/*
Note how the sent time must be carefully <a href="uMail_i.html#jMessage">initialized</a>, as the constructor for
java.util.GregorianCalendar by which we represent the date/time in Java does
not accept any of our data in its constructors.
*/</font>
<font color=#0000FF>class</font> jMessage : <font color=#0000FF>public</font> jType
{
<font color=#0000FF>private</font>:
    Message* message;
       Root* root;
<font color=#0000FF>public</font>:
    jMessage(<font color=#009900>void</font>* m);
    
    jAddressee* getFrom();
    jAddressee* getTo();
    <font color=#009900>char</font>* getSubject();
    <font color=#009900>char</font>* getBody();
    
    <font color=#009900>void</font> setTo(<font color=#009900>char</font>* address);
    <font color=#009900>void</font> setSubject(<font color=#009900>char</font>* subject);
    <font color=#009900>void</font> setBody(<font color=#009900>char</font>* body);

<font color=#9A1900>// impl only (getSentTime() must include call to init(), 
</font><font color=#9A1900>// so it is attached to jTime.java via SWIG typemap in uMail.i)
</font>    jTime* _getSentTime();
    <font color=#0000FF>friend</font> <font color=#0000FF>class</font> jFolder;
};

<font color=#9A1900>// <a name="function_pointer"/>
</font><font color=#9A1900>/*
Function pointer example:

The following typedefs represent the method signatures of the members of 
<a href="account.html#Folder">Folder</a>, which is essentially represented by jFolder. Pointers to the 
actual methods of Folder can be passed to this library upon <a href="plugin.html#jPluginLib">initialization</a> and applied to 
the static members below.  In the process of plugin operation, method calls 
intended for Folder would then arrive at this class from Java with
a pointer to Folder.  To avoid linking with account.o, the pointer to Folder
is cast to an instance of its superclass Root, and the appropriate method, identified
by name, is called on that faux instance of <a href="plugin.html#Root">Root</a>.  

typedef void (Root::*V_E)();
typedef void  (Root::*V_Vp)(void*);
typedef void (Root::*V_I)(int);
typedef void (Root::*V_Cp)(char*);
typedef void (Root::*V_B)(bool);
typedef void (Root::*V_S)(string);

typedef void* (Root::*Vp_Cp)(char*);
typedef void* (Root::*Vp_SB)(string, bool);
typedef void* (Root::*Vp_E)();

typedef int (Root::*I_E)();
typedef string (Root::*S_E)();

typedef Root* (*cx_Vp)(void*);
typedef Root* (*cx_Cp)(char*);

Key for pointer names:
E: empty
V: void
I: int
S: string
B: bool
p: pointer
*/</font>

<font color=#9A1900>// <a name="jFolder"/>
</font><font color=#0000FF>class</font> jFolder : <font color=#0000FF>public</font> jType
{
<font color=#0000FF>private</font>:
    Folder* folder;
    Root* root;

<font color=#9A1900>/* Function pointer example
    static cx_Cp* r;
    static S_E* r_getName;
    static V_Vp* r_addMessage;
    static V_Vp* r_addFolder;
    static Vp_SB* r_getSubFolder;
    static V_I* r_remove;
    static I_E* r_getSize;
    static Vp_E* r_getMessages;
    static Vp_E* r_getParent;
    static Vp_E* r_getSubFolders;
*/</font>    
<font color=#0000FF>public</font>:
    jFolder(<font color=#009900>void</font>* f);
    jFolder(<font color=#009900>char</font>* name);
    
    <font color=#0000FF>const</font> <font color=#009900>char</font>* getName();
    <font color=#009900>void</font> add(jMessage* message);
    <font color=#009900>void</font> add(jFolder* f);
    jFolder* getSubFolder(<font color=#009900>char</font>* name);
    jFolder* getSubFolder(<font color=#009900>char</font>* name, <font color=#009900>bool</font> createIfNecessary);
    <font color=#009900>void</font> remove(<font color=#009900>int</font> index);
    <font color=#009900>int</font> getSize();
    uIterator* getMessages();
    jFolder* getParent();
    uIterator* getSubFolders();
    
    <font color=#0000FF>friend</font> <font color=#0000FF>class</font> jMail;
};
    
<font color=#9A1900>// <a name="jAccount"/>
</font><font color=#0000FF>class</font> jAccount : <font color=#0000FF>public</font> jType
{
<font color=#0000FF>private</font>:
    Account* account;
<font color=#0000FF>public</font>:
    jAccount(<font color=#009900>void</font>* a); 
    jFolder* getRoot();
    jAddressee* getUser();
    <font color=#009900>void</font> log(<font color=#009900>char</font>* message);
};

<font color=#9A1900>// <a name="jMenu"/>
</font><font color=#0000FF>class</font> jMenu : <font color=#0000FF>public</font> jType
{
<font color=#0000FF>private</font>:
    Menu* menu;
<font color=#0000FF>public</font>:
    jMenu(<font color=#009900>void</font>* m);
    <font color=#009900>int</font> getSize();
    <font color=#009900>void</font> go();
    <font color=#009900>void</font> append(jType* option);
};

<font color=#9A1900>// <a name="jMenuOption"/>
</font><font color=#0000FF>class</font> jMenuOption : <font color=#0000FF>public</font> jType
{
<font color=#0000FF>private</font>:
    PluginMenuOption* option;
<font color=#0000FF>public</font>:
    jMenuOption(<font color=#009900>void</font>* o);
    jMenuOption(<font color=#009900>char</font>* text, <font color=#009900>char</font>* runMethodName);
    
    <font color=#0000FF>const</font> <font color=#009900>char</font>* getDisplayText();
};

<font color=#9A1900>// <a name="jFolderMenuOption"/>
</font><font color=#0000FF>class</font> jFolderMenuOption : <font color=#0000FF>public</font> jType
{
<font color=#0000FF>private</font>:
    FolderMenuOption* option;
<font color=#0000FF>public</font>:
    jFolderMenuOption(<font color=#009900>void</font>* o);
    jFolderMenuOption(<font color=#009900>char</font>* text, jFolder* folder);
    
    <font color=#0000FF>const</font> <font color=#009900>char</font>* getDisplayText();
};

<font color=#9A1900>// <a name="jMessageMenuOption"/>
</font><font color=#0000FF>class</font> jMessageMenuOption : <font color=#0000FF>public</font> jType
{
<font color=#0000FF>private</font>:
    MessageMenuOption* option;
<font color=#0000FF>public</font>:
    jMessageMenuOption(<font color=#009900>void</font>* o);
    jMessageMenuOption(<font color=#009900>char</font>* text, jMessage* message);
    
    <font color=#0000FF>const</font> <font color=#009900>char</font>* getDisplayText();
};

<font color=#9A1900>// <a name="jFolderMenuPlugin"/>
</font><font color=#0000FF>class</font> jFolderMenuPlugin : <font color=#0000FF>public</font> jType
{
<font color=#0000FF>private</font>:
    PluginFolderMenuOption* option;
<font color=#0000FF>public</font>:
    jFolderMenuPlugin(<font color=#009900>void</font>* o);
    jFolderMenuPlugin(<font color=#009900>char</font>* text, jFolder* folder, <font color=#009900>char</font>* runMethodName);
    
    <font color=#0000FF>const</font> <font color=#009900>char</font>* getDisplayText();
};

<font color=#9A1900>// <a name="jPrompt"/>
</font><font color=#0000FF>class</font> jPrompt : <font color=#0000FF>public</font> jType
{
<font color=#0000FF>private</font>:
    Prompt* prompt;
<font color=#0000FF>public</font>:
    jPrompt(<font color=#009900>void</font>* p);
    jPrompt(<font color=#009900>char</font>* display, <font color=#009900>bool</font> isAtomic);
    <font color=#009900>char</font>* askUser();
    <font color=#009900>char</font>* askUser(<font color=#009900>char</font>* defaultResponse);
};

<font color=#9A1900>// <a name="jMessageInput"/>
</font><font color=#0000FF>class</font> jMessageInput : <font color=#0000FF>public</font> jType
{
<font color=#0000FF>private</font>:
    MessageInput* messageInput;
<font color=#0000FF>public</font>:
    jMessageInput(<font color=#009900>void</font>* m);
    jPrompt* getToPrompt();
    jPrompt* getSubjectPrompt();
    jPrompt* getBodyPrompt();
    jMessage* getMessage();
};

<font color=#9A1900>// <a name="jDataDisplay"/>
</font><font color=#0000FF>class</font> jDataDisplay : <font color=#0000FF>public</font> jType
{
<font color=#0000FF>private</font>:
    DataDisplay* dataDisplay;
<font color=#0000FF>public</font>:
    jDataDisplay(<font color=#009900>void</font>* d);
    <font color=#009900>void</font> setLabel(<font color=#009900>char</font>* l);
    <font color=#009900>void</font> setValue(<font color=#009900>char</font>* v);
    <font color=#009900>void</font> display();
};

<font color=#9A1900>// <a name="jMessageDisplay"/>
</font><font color=#0000FF>class</font> jMessageDisplay : <font color=#0000FF>public</font> jType
{
<font color=#0000FF>private</font>:
    MessageDisplay* messageDisplay;
<font color=#0000FF>public</font>:
    jMessageDisplay(<font color=#009900>void</font>* m);
    jDataDisplay* getFrom();
    jDataDisplay* getSubject();
    jDataDisplay* getBody();
    jDataDisplay* getSentTime();
    jMessage* getMessage();
    <font color=#009900>void</font> initValues();
    <font color=#009900>void</font> align();
};

<font color=#9A1900>/* Function pointer example:
class jMail
{
public:
    static void init();
};
*/</font>

<font color=#0000FF>#endif</font>                                                              
</tt>
</pre>
</body>
</html>
<p>&nbsp;<p>&nbsp;<p>&nbsp;<p>&nbsp;<p>&nbsp;<p>&nbsp;<p>&nbsp;<p>